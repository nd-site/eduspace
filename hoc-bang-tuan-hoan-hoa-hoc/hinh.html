<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥ ph·ªèng Layout EduSpace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading-shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
    <script src="/nd-navbar.js" defer></script></head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-2xl w-full text-center">
        <h1 class="text-2xl font-black text-slate-800 mb-2">B·∫¢N V·∫º M√î PH·ªéNG PIXEL-PERFECT</h1>
        <p class="text-slate-500 mb-6 font-medium">ƒêang t·∫°o h√¨nh ·∫£nh d·ª±a tr√™n c√°c th√¥ng s·ªë: 30px, 5px, 25px, 15px, 5px.</p>

        <div id="image-container" class="relative aspect-square w-full max-w-[500px] mx-auto bg-slate-50 rounded-2xl border-2 border-dashed border-slate-300 flex items-center justify-center overflow-hidden">
            <!-- Loading Indicator -->
            <div id="loading" class="flex flex-col items-center">
                <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"></div>
                <p class="font-bold text-blue-500 animate-pulse">ƒêANG V·∫º...</p>
            </div>
            <img id="generated-image" class="hidden w-full h-full object-contain" alt="EduSpace Card Preview">
        </div>

        <div id="error-box" class="hidden mt-4 p-4 bg-red-50 text-red-600 rounded-xl font-bold border border-red-200">
            Kh√¥ng th·ªÉ t·∫°o ·∫£nh. Vui l√≤ng th·ª≠ l·∫°i.
        </div>

        <div class="mt-8 grid grid-cols-2 gap-4 text-left text-sm">
            <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                <p class="font-bold text-blue-800 underline mb-2">Th√¥ng s·ªë Header:</p>
                <ul class="text-blue-700 space-y-1">
                    <li>‚Ä¢ Margin Top: 30px</li>
                    <li>‚Ä¢ Gap Title-Sub: 5px</li>
                </ul>
            </div>
            <div class="bg-orange-50 p-4 rounded-xl border border-orange-100">
                <p class="font-bold text-orange-800 underline mb-2">Th√¥ng s·ªë Content:</p>
                <ul class="text-orange-700 space-y-1">
                    <li>‚Ä¢ Gap Sub-Streak: 25px</li>
                    <li>‚Ä¢ Gap Streak-Text: 15px</li>
                    <li>‚Ä¢ Margin Bottom: 5px</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "";
        
        async function generateImage() {
            const container = document.getElementById('image-container');
            const loading = document.getElementById('loading');
            const imgElement = document.getElementById('generated-image');
            const errorBox = document.getElementById('error-box');

            const prompt = `A clean, flat design of a 500x500 square card. White background, thick blue border (15px). Text at the top: 'EduSpace' in large blue font, followed by a small 'by ND Labs' below it. In the center, a very large orange number '5' with the text 'Chu·ªói r·ª±c ch√°y üî•' below it. At the very bottom, a light blue rectangle with text 'K·ª∑ l·ª•c m·ªõi c·ªßa t√¥i!' that ends exactly 5px from the bottom border. Professional UI layout, high contrast.`;

            const payload = {
                contents: [{
                    parts: [{ text: prompt }]
                }],
                generationConfig: {
                    responseModalities: ['TEXT', 'IMAGE']
                }
            };

            let retries = 0;
            const maxRetries = 5;

            async function makeRequest() {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error('API Error');

                    const result = await response.json();
                    const base64Data = result.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;

                    if (base64Data) {
                        imgElement.src = `data:image/png;base64,${base64Data}`;
                        imgElement.classList.remove('hidden');
                        loading.classList.add('hidden');
                    } else {
                        throw new Error('No image in response');
                    }
                } catch (error) {
                    if (retries < maxRetries) {
                        retries++;
                        const delay = Math.pow(2, retries) * 500;
                        setTimeout(makeRequest, delay);
                    } else {
                        loading.classList.add('hidden');
                        errorBox.classList.remove('hidden');
                    }
                }
            }

            makeRequest();
        }

        window.onload = generateImage;
    </script>
</body>
</html>