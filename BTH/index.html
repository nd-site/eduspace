<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng Tu·∫ßn Ho√†n H√≥a H·ªçc - EduSpace by ND Labs</title>
    <link rel="icon" href="/logo.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            --primary-color: #2563eb; 
            --primary-dark: #1d4ed8;  
            --streak-color: #ff9600;
        }

        body { 
            font-family: 'Be Vietnam Pro', sans-serif; 
            background-color: #ffffff;
            color: #4b4b4b;
            overflow: hidden;
            height: 100vh;
        }

        /* HI·ªÜU ·ª®NG T·ªéA NHI·ªÜT (HEAT GLOW) */
        .fire-glow {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: #ff9600;
        }
        
        .fire-glow::after {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 150, 0, 0.5) 0%, rgba(255, 100, 0, 0.2) 40%, transparent 70%);
            filter: blur(20px);
            z-index: -1;
            animation: heatPulse 1.5s infinite alternate ease-in-out;
        }

        @keyframes heatPulse {
            0% { transform: scale(0.85); opacity: 0.3; }
            100% { transform: scale(1.2); opacity: 0.9; }
        }

        @keyframes fireFloat {
            0% { transform: translateY(0); filter: drop-shadow(0 0 5px rgba(255,150,0,0.5)); }
            100% { transform: translateY(-12px); filter: drop-shadow(0 0 25px rgba(255,150,0,0.9)); }
        }
        
        .fire-hero {
            animation: fireFloat 1s ease-in-out infinite alternate;
        }

        .duo-btn-primary {
            background-color: var(--primary-color);
            border-bottom: 5px solid var(--primary-dark);
            transition: all 0.1s;
        }
        .duo-btn-primary:active {
            border-bottom-width: 0;
            transform: translateY(5px);
        }

        .duo-input {
            border: 2px solid #e5e5e5;
            border-bottom-width: 5px;
            transition: all 0.2s;
        }
        .duo-input:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        /* Modal Overlay */
        #share-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(15px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* Card Preview - Ch·ªâ d√πng ƒë·ªÉ xem tr∆∞·ªõc */
        #card-preview {
            width: 350px;
            height: 350px;
            background: white;
            border-radius: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 30px;
            border: 8px solid var(--primary-color);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

    </style>
    <script src="/nd-navbar.js" defer></script></head>
<body class="flex flex-col">

    <nav class="bg-white border-b-2 border-slate-100 px-6 py-4 flex items-center justify-between z-10">
        <div class="flex items-center space-x-3">
            <a href="/eduspace" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-50 text-slate-400 border-b-4 border-slate-200">
                <i class="fas fa-home"></i>
            </a>
            <div class="flex flex-col leading-none">
                <span class="font-black text-2xl tracking-tight text-[#2563eb]">EduSpace</span>
                <span class="text-[10px] font-bold text-slate-400 tracking-widest uppercase">by ND Labs</span>
            </div>
        </div>
        <div id="streakDisplay" class="hidden flex items-center space-x-2 font-extrabold text-[#ff9600]">
            <div class="fire-glow scale-75">
                <i class="fas fa-fire text-2xl"></i>
            </div>
            <span id="streakValue" class="text-2xl">0</span>
        </div>
    </nav>

    <main class="flex-grow relative flex flex-col items-center justify-start pt-10 p-4">
        <div id="quiz-container" class="w-full max-w-xl">
            
            <!-- Setup View -->
            <div id="setup-view" class="text-center space-y-12 flex flex-col items-center">
                <div class="fire-glow fire-hero text-9xl mt-8">
                    <i class="fas fa-fire"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black text-slate-800 uppercase italic tracking-tight">S·∫µn s√†ng r·ª±c ch√°y?</h1>
                    <p class="text-slate-400 font-medium">Th·ª≠ th√°ch tr√≠ nh·ªõ s·ªë hi·ªáu nguy√™n t·ª≠ ngay b√¢y gi·ªù.</p>
                </div>
                <button onclick="startQuiz()" class="w-full duo-btn-primary text-white py-4 rounded-2xl font-black text-xl uppercase tracking-widest">B·∫Øt ƒë·∫ßu</button>
            </div>

            <!-- Question View -->
            <div id="question-view" class="hidden space-y-10">
                <div class="text-center">
                    <h2 id="elementName" class="text-xl font-bold text-slate-400 uppercase tracking-widest mb-2">---</h2>
                    <p id="elementSymbol" class="text-[8rem] leading-none font-black text-slate-800">?</p>
                </div>
                <div class="space-y-6">
                    <input type="number" id="atomicInput" placeholder="Z =" class="w-full text-center text-4xl font-black p-6 duo-input rounded-3xl">
                    <button onclick="check()" class="w-full duo-btn-primary text-white py-5 rounded-2xl font-black text-xl uppercase tracking-widest">Ki·ªÉm tra</button>
                </div>
            </div>

            <!-- Result View -->
            <div id="result-view" class="hidden text-center space-y-6">
                <div class="fire-glow text-7xl mb-4">
                    <i class="fas fa-fire"></i>
                </div>
                <h2 class="text-3xl font-black text-slate-800 uppercase">K·∫øt th√∫c!</h2>
                <div class="bg-slate-50 p-8 rounded-[2rem] border-2 border-slate-200">
                    <p class="text-slate-400 font-bold uppercase text-xs mb-1">Chu·ªói hi·ªán t·∫°i</p>
                    <span id="finalStreakNumber" class="text-8xl font-black text-[#ff9600]">0</span>
                </div>
                <div class="flex flex-col space-y-3">
                    <button onclick="openShareModal()" class="w-full py-4 bg-slate-800 text-white rounded-2xl font-black uppercase shadow-lg">
                        <i class="fas fa-camera mr-2"></i> L∆∞u "chu·ªói k·ª∑ l·ª•c" c·ªßa b·∫°n
                    </button>
                    <button onclick="startQuiz()" class="w-full duo-btn-primary text-white py-4 rounded-2xl font-black uppercase">Ch∆°i l·∫°i</button>
                </div>
            </div>
        </div>

        <div id="footer-overlay" class="absolute bottom-0 left-0 w-full p-6 transition-all duration-300 translate-y-full z-50">
            <div class="max-w-xl mx-auto flex items-center justify-between">
                <div id="footer-content" class="flex items-center space-x-4"></div>
                <button onclick="nextQuestion()" class="px-8 py-3 rounded-2xl font-black uppercase bg-white shadow-xl">Ti·∫øp t·ª•c</button>
            </div>
        </div>
    </main>

    <!-- Modal Chia s·∫ª -->
    <div id="share-modal" onclick="closeShareModal()">
        <div class="flex flex-col items-center space-y-6" onclick="event.stopPropagation()">
            
            <div id="card-preview">
                <div class="text-center">
                    <div class="text-3xl font-black text-blue-600 leading-none">EduSpace</div>
                    <div class="text-[10px] font-bold text-slate-400 tracking-[3px] uppercase mt-1">by ND Labs</div>
                </div>

                <div class="text-center">
                    <div id="share-streak-val" class="text-8xl font-black text-orange-500 leading-none">0</div>
                    <div class="text-lg font-black text-orange-400 uppercase mt-2">Chu·ªói r·ª±c ch√°y üî•</div>
                </div>

                <div class="bg-blue-50 w-full py-3 rounded-2xl text-center">
                    <div class="text-blue-800 font-black">K·ª∑ l·ª•c m·ªõi c·ªßa t√¥i!</div>
                </div>
            </div>

            <div class="flex flex-col w-full space-y-3">
                <button onclick="drawAndDownload()" class="w-full py-5 bg-blue-600 text-white rounded-2xl font-black uppercase text-lg shadow-2xl">
                    <i class="fas fa-download mr-2"></i> T·∫£i "chu·ªói k·ª∑ l·ª•c" c·ªßa b·∫°n
                </button>
                <button onclick="closeShareModal()" class="text-white/60 font-bold uppercase text-sm">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <script>
        const elements = [
            { z: 1, s: "H", n: "Hydrogen" },
            { z: 2, s: "He", n: "Helium" },
            { z: 3, s: "Li", n: "Lithium" },
            { z: 4, s: "Be", n: "Beryllium" },
            { z: 5, s: "B", n: "Boron" },
            { z: 6, s: "C", n: "Carbon" },
            { z: 7, s: "N", n: "Nitrogen" },
            { z: 8, s: "O", n: "Oxygen" },
            { z: 9, s: "F", n: "Fluorine" },
            { z: 10, s: "Ne", n: "Neon" },
            { z: 11, s: "Na", n: "Sodium" },
            { z: 12, s: "Mg", n: "Magnesium" },
            { z: 13, s: "Al", n: "Aluminium" },
            { z: 14, s: "Si", n: "Silicon" },
            { z: 15, s: "P", n: "Phosphorus" },
            { z: 16, s: "S", n: "Sulfur" },
            { z: 17, s: "Cl", n: "Chlorine" },
            { z: 18, s: "Ar", n: "Argon" },
            { z: 19, s: "K", n: "Potassium" },
            { z: 20, s: "Ca", n: "Calcium" },
            { z: 21, s: "Sc", n: "Scandium" },
            { z: 22, s: "Ti", n: "Titanium" },
            { z: 23, s: "V", n: "Vanadium" },
            { z: 24, s: "Cr", n: "Chromium" },
            { z: 25, s: "Mn", n: "Manganese" },
            { z: 26, s: "Fe", n: "Iron" },
            { z: 27, s: "Co", n: "Cobalt" },
            { z: 28, s: "Ni", n: "Nickel" },
            { z: 29, s: "Cu", n: "Copper" },
            { z: 30, s: "Zn", n: "Zinc" },
            { z: 31, s: "Ga", n: "Gallium" },
            { z: 32, s: "Ge", n: "Germanium" },
            { z: 33, s: "As", n: "Arsenic" },
            { z: 34, s: "Se", n: "Selenium" },
            { z: 35, s: "Br", n: "Bromine" },
            { z: 36, s: "Kr", n: "Krypton" },
            { z: 37, s: "Rb", n: "Rubidium" },
            { z: 38, s: "Sr", n: "Strontium" },
            { z: 39, s: "Y", n: "Yttrium" },
            { z: 40, s: "Zr", n: "Zirconium" },
            { z: 41, s: "Nb", n: "Niobium" },
            { z: 42, s: "Mo", n: "Molybdenum" },
            { z: 43, s: "Tc", n: "Technetium" },
            { z: 44, s: "Ru", n: "Ruthenium" },
            { z: 45, s: "Rh", n: "Rhodium" },
            { z: 46, s: "Pd", n: "Palladium" },
            { z: 47, s: "Ag", n: "Silver" },
            { z: 48, s: "Cd", n: "Cadmium" },
            { z: 49, s: "In", n: "Indium" },
            { z: 50, s: "Sn", n: "Tin" },
            { z: 51, s: "Sb", n: "Antimony" },
            { z: 52, s: "Te", n: "Tellurium" },
            { z: 53, s: "I", n: "Iodine" },
            { z: 54, s: "Xe", n: "Xenon" },
            { z: 55, s: "Cs", n: "Cesium" },
            { z: 56, s: "Ba", n: "Barium" },
            { z: 57, s: "La", n: "Lanthanum" },
            { z: 58, s: "Ce", n: "Cerium" },
            { z: 59, s: "Pr", n: "Praseodymium" },
            { z: 60, s: "Nd", n: "Neodymium" },
            { z: 61, s: "Pm", n: "Promethium" },
            { z: 62, s: "Sm", n: "Samarium" },
            { z: 63, s: "Eu", n: "Europium" },
            { z: 64, s: "Gd", n: "Gadolinium" },
            { z: 65, s: "Tb", n: "Terbium" },
            { z: 66, s: "Dy", n: "Dysprosium" },
            { z: 67, s: "Ho", n: "Holmium" },
            { z: 68, s: "Er", n: "Erbium" },
            { z: 69, s: "Tm", n: "Thulium" },
            { z: 70, s: "Yb", n: "Ytterbium" },
            { z: 71, s: "Lu", n: "Lutetium" },
            { z: 72, s: "Hf", n: "Hafnium" },
            { z: 73, s: "Ta", n: "Tantalum" },
            { z: 74, s: "W", n: "Tungsten" },
            { z: 75, s: "Re", n: "Rhenium" },
            { z: 76, s: "Os", n: "Osmium" },
            { z: 77, s: "Ir", n: "Iridium" },
            { z: 78, s: "Pt", n: "Platinum" },
            { z: 79, s: "Au", n: "Gold" },
            { z: 80, s: "Hg", n: "Mercury" },
            { z: 81, s: "Tl", n: "Thallium" },
            { z: 82, s: "Pb", n: "Lead" },
            { z: 83, s: "Bi", n: "Bismuth" },
            { z: 84, s: "Po", n: "Polonium" },
            { z: 85, s: "At", n: "Astatine" },
            { z: 86, s: "Rn", n: "Radon" },
            { z: 87, s: "Fr", n: "Francium" },
            { z: 88, s: "Ra", n: "Radium" },
            { z: 89, s: "Ac", n: "Actinium" },
            { z: 90, s: "Th", n: "Thorium" },
            { z: 91, s: "Pa", n: "Protactinium" },
            { z: 92, s: "U", n: "Uranium" },
            { z: 93, s: "Np", n: "Neptunium" },
            { z: 94, s: "Pu", n: "Plutonium" },
            { z: 95, s: "Am", n: "Americium" },
            { z: 96, s: "Cm", n: "Curium" },
            { z: 97, s: "Bk", n: "Berkelium" },
            { z: 98, s: "Cf", n: "Californium" },
            { z: 99, s: "Es", n: "Einsteinium" },
            { z: 100, s: "Fm", n: "Fermium" },
            { z: 101, s: "Md", n: "Mendelevium" },
            { z: 102, s: "No", n: "Nobelium" },
            { z: 103, s: "Lr", n: "Lawrencium" },
            { z: 104, s: "Rf", n: "Rutherfordium" },
            { z: 105, s: "Db", n: "Dubnium" },
            { z: 106, s: "Sg", n: "Seaborgium" },
            { z: 107, s: "Bh", n: "Bohrium" },
            { z: 108, s: "Hs", n: "Hassium" },
            { z: 109, s: "Mt", n: "Meitnerium" },
            { z: 110, s: "Ds", n: "Darmstadtium" },
            { z: 111, s: "Rg", n: "Roentgenium" },
            { z: 112, s: "Cn", n: "Copernicium" },
            { z: 113, s: "Nh", n: "Nihonium" },
            { z: 114, s: "Fl", n: "Flerovium" },
            { z: 115, s: "Mc", n: "Moscovium" },
            { z: 116, s: "Lv", n: "Livermorium" },
            { z: 117, s: "Ts", n: "Tennessine" },
            { z: 118, s: "Og", n: "Oganesson" } /**,
            { z: 119, s: "Uue", n: "Ununennium" },
            { z: 120, s: "Ubn", n: "Unbinilium" },
            { z: 121, s: "Ubu", n: "Unbiunium" },
            { z: 122, s: "Ubb", n: "Unbibium" },
            { z: 123, s: "Ubt", n: "Unbitrium" },
            { z: 124, s: "Ubq", n: "Unbiquadium" },
            { z: 125, s: "Ubp", n: "Unbipentium" },
            { z: 126, s: "Ubh", n: "Unbihexium" },
            { z: 127, s: "Ubs", n: "Unbiseptium" },
            { z: 128, s: "Ubo", n: "Unbioctium" },
            { z: 129, s: "Ube", n: "Unbiennium" },
            { z: 130, s: "Utn", n: "Untrinilium" },
            { z: 131, s: "Utu", n: "Untriunium" },
            { z: 132, s: "Utb", n: "Untribium" },
            { z: 133, s: "Utt", n: "Untritrium" },
            { z: 134, s: "Utq", n: "Untriquadium" },
            { z: 135, s: "Utp", n: "Untripentium" },
            { z: 136, s: "Uth", n: "Untrihexium" },
            { z: 137, s: "Uts", n: "Untriseptium" },
            { z: 138, s: "Uto", n: "Untrioctium" },
            { z: 139, s: "Ute", n: "Untriennium" },
            { z: 140, s: "Pbn", n: "Unquadnilium" },
            { z: 141, s: "Pbu", n: "Unquadunium" },
            { z: 142, s: "Pbb", n: "Unquadbium" },
            { z: 143, s: "Pbt", n: "Unquadtirium" },
            { z: 144, s: "Pbq", n: "Unquadquadium" },
            { z: 145, s: "Pbp", n: "Unquadpentium" },
            { z: 146, s: "Pbh", n: "Unquadhexium" },
            { z: 147, s: "Pbs", n: "Unquadseptium" },
            { z: 148, s: "Pbo", n: "Unquadoctium" },
            { z: 149, s: "Pbe", n: "Unquadennium" },
            { z: 150, s: "Uqn", n: "Unquinilium" },
            { z: 151, s: "Uqu", n: "Unquinunium" },
            { z: 152, s: "Uqb", n: "Unquinbium" },
            { z: 153, s: "Uqt", n: "Unquitririum" },
            { z: 154, s: "Uqq", n: "Unquiquadium" },
            { z: 155, s: "Uqp", n: "Unquipentium" },
            { z: 156, s: "Uqh", n: "Unquihexium" },
            { z: 157, s: "Uqs", n: "Unquiseptium" },
            { z: 158, s: "Uqo", n: "Unquioctium" },
            { z: 159, s: "Uqe", n: "Unquiennium" },
            { z: 160, s: "Hex", n: "Unhexnilium" },
            { z: 161, s: "Hex", n: "Unhexunium" },
            { z: 162, s: "Hex", n: "Unhexbium" },
            { z: 163, s: "Hex", n: "Unhextirium" },
            { z: 164, s: "Hex", n: "Unhexquadium" },
            { z: 165, s: "Hex", n: "Unhexpentium" },
            { z: 166, s: "Hex", n: "Unhexhexium" },
            { z: 167, s: "Hex", n: "Unhexseptium" },
            { z: 168, s: "Hex", n: "Unhexoctium" },
            { z: 169, s: "Hex", n: "Unhexennium" },
            { z: 170, s: "Hept", n: "Unheptnilium" },
            { z: 171, s: "Hept", n: "Unheptunium" },
            { z: 172, s: "Hept", n: "Unheptbium" },
            { z: 173, s: "Hept", n: "Unhepttirium" },
            { z: 174, s: "Hept", n: "Unheptquadium" },
            { z: 175, s: "Hept", n: "Unheptpentium" },
            { z: 176, s: "Hept", n: "Unhepthexium" },
            { z: 177, s: "Hept", n: "Unheptseptium" },
            { z: 178, s: "Hept", n: "Unheptoctium" },
            { z: 179, s: "Hept", n: "Unheptennium" },
            { z: 180, s: "Oct", n: "Unoctnilium" },
            { z: 181, s: "Oct", n: "Unoctunium" },
            { z: 182, s: "Oct", n: "Unoctbium" },
            { z: 183, s: "Oct", n: "Unocttirium" },
            { z: 184, s: "Oct", n: "Unoctquadium" },
            { z: 185, s: "Oct", n: "Unoctpentium" },
            { z: 186, s: "Oct", n: "Unocthexium" },
            { z: 187, s: "Oct", n: "Unoctseptium" },
            { z: 188, s: "Oct", n: "Unoctoctium" },
            { z: 189, s: "Oct", n: "Unoctennium" },
            { z: 190, s: "Enn", n: "Unennilium" },
            { z: 191, s: "Enn", n: "Unennunium" },
            { z: 192, s: "Enn", n: "Unennbium" },
            { z: 193, s: "Enn", n: "Unenntirium" },
            { z: 194, s: "Enn", n: "Unennquadium" },
            { z: 195, s: "Enn", n: "Unennpentium" },
            { z: 196, s: "Enn", n: "Unennhexium" },
            { z: 197, s: "Enn", n: "Unennseptium" },
            { z: 198, s: "Enn", n: "Unennoctium" },
            { z: 199, s: "Enn", n: "Unennennium" },
            { z: 200, s: "Duo", n: "Duoennilium" }, */
        ];

        let streak = 0, currentIdx = 0, pool = [];

        function startQuiz() {
            pool = [...elements].sort(() => Math.random() - 0.5);
            streak = 0; currentIdx = 0;
            document.getElementById('setup-view').classList.add('hidden');
            document.getElementById('result-view').classList.add('hidden');
            document.getElementById('question-view').classList.remove('hidden');
            document.getElementById('streakDisplay').classList.remove('hidden');
            document.getElementById('streakValue').innerText = '0';
            showQuestion();
        }

        function showQuestion() {
            const el = pool[currentIdx];
            document.getElementById('elementName').innerText = el.n;
            document.getElementById('elementSymbol').innerText = el.s;
            document.getElementById('footer-overlay').classList.add('translate-y-full');
            const inp = document.getElementById('atomicInput');
            inp.value = ''; inp.disabled = false;
            setTimeout(() => inp.focus(), 100);
        }

        function check() {
            const el = pool[currentIdx];
            const inp = document.getElementById('atomicInput');
            const val = parseInt(inp.value);
            if (isNaN(val)) return;
            inp.disabled = true;

            const overlay = document.getElementById('footer-overlay');
            if (val === el.z) {
                streak++;
                overlay.className = "absolute bottom-0 left-0 w-full p-6 transition-all duration-300 translate-y-0 z-50 bg-[#dcfce7]";
                document.getElementById('footer-content').innerHTML = `
                    <div class="fire-glow scale-50 bg-white rounded-full p-2 text-green-500"><i class="fas fa-check"></i></div>
                    <div><h3 class="text-green-700 font-black text-xl">Ch√≠nh x√°c!</h3></div>`;
                document.getElementById('streakValue').innerText = streak;
                setTimeout(nextQuestion, 1200);
            } else {
                overlay.className = "absolute bottom-0 left-0 w-full p-6 transition-all duration-300 translate-y-0 z-50 bg-[#fee2e2]";
                document.getElementById('footer-content').innerHTML = `
                    <div class="bg-white rounded-full w-10 h-10 flex items-center justify-center text-red-500 shadow-sm"><i class="fas fa-times"></i></div>
                    <div><h3 class="text-red-700 font-black text-xl">Sai r·ªìi! Z = ${el.z}</h3></div>`;
                setTimeout(endGame, 1000);
            }
        }

        function nextQuestion() {
            currentIdx++;
            if (currentIdx >= pool.length) currentIdx = 0;
            showQuestion();
        }

        function endGame() {
            document.getElementById('question-view').classList.add('hidden');
            document.getElementById('footer-overlay').classList.add('translate-y-full');
            document.getElementById('result-view').classList.remove('hidden');
            document.getElementById('finalStreakNumber').innerText = streak;
            document.getElementById('share-streak-val').innerText = streak;
        }

        function openShareModal() {
            document.getElementById('share-modal').style.display = 'flex';
        }

        function closeShareModal() {
            document.getElementById('share-modal').style.display = 'none';
        }

        /**
         * H√ÄM V·∫º T·ª∞ ƒê·ªòNG C·∫¢I TI·∫æN
         * ƒê·∫£m b·∫£o bo g√≥c n·ªÅn tr·∫Øng tuy·ªát ƒë·ªëi cho ·∫£nh t·∫£i v·ªÅ.
         */
        function drawAndDownload() {
            const size = 1000;
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');
            const radius = 120; // TƒÉng b√°n k√≠nh bo g√≥c cho ƒë·∫πp

            // 1. X√≥a s·∫°ch canvas ƒë·ªÉ n·ªÅn trong su·ªët ·ªü 4 g√≥c
            ctx.clearRect(0, 0, size, size);

            // 2. T·∫°o Path bo g√≥c chu·∫©n cho to√†n b·ªô canvas
            ctx.beginPath();
            ctx.moveTo(radius, 0);
            ctx.lineTo(size - radius, 0);
            ctx.quadraticCurveTo(size, 0, size, radius);
            ctx.lineTo(size, size - radius);
            ctx.quadraticCurveTo(size, size, size - radius, size);
            ctx.lineTo(radius, size);
            ctx.quadraticCurveTo(0, size, 0, size - radius);
            ctx.lineTo(0, radius);
            ctx.quadraticCurveTo(0, 0, radius, 0);
            ctx.closePath();
            
            // C·∫Øt v√πng v·∫Ω (Clip) - M·ªçi th·ª© v·∫Ω sau n√†y ch·ªâ n·∫±m trong v√πng bo tr√≤n
            ctx.clip();

            // 3. ƒê·ªï n·ªÅn tr·∫Øng (L√∫c n√†y n·ªÅn tr·∫Øng s·∫Ω b·ªã gi·ªõi h·∫°n b·ªüi clip b√™n tr√™n)
            ctx.fillStyle = "#ffffff";
            ctx.fillRect(0, 0, size, size);

            // 4. V·∫Ω vi·ªÅn xanh (Border) - V·∫Ω ƒë√® l√™n m√©p c·ªßa clip
            ctx.strokeStyle = "#2563eb";
            ctx.lineWidth = 60;
            ctx.strokeRect(0, 0, size, size);

            // 5. V·∫Ω vƒÉn b·∫£n (S·ª≠ d·ª•ng Font d·ª± ph√≤ng n·∫øu Google Font ch∆∞a load k·ªãp)
            ctx.textAlign = "center";
            ctx.fillStyle = "#2563eb";
            ctx.font = "900 85px 'Be Vietnam Pro', sans-serif, Arial";
            ctx.fillText("EduSpace", size/2, 210);

            ctx.fillStyle = "#94a3b8";
            ctx.font = "800 24px 'Be Vietnam Pro', sans-serif, Arial";
            ctx.fillText("BY ND LABS", size/2, 260);

            // 6. Con s·ªë streak
            ctx.fillStyle = "#ff9600";
            ctx.font = "900 380px 'Be Vietnam Pro', sans-serif, Arial";
            ctx.fillText(streak, size/2, 620);

            ctx.font = "900 55px 'Be Vietnam Pro', sans-serif, Arial";
            ctx.fillText("CHU·ªñI R·ª∞C CH√ÅY üî•", size/2, 700);

            // 7. Badge Footer
            const badgeW = 740;
            const badgeH = 130;
            const badgeX = (size - badgeW) / 2;
            const badgeY = 800;
            
            ctx.fillStyle = "#eff6ff";
            ctx.beginPath();
            // V·∫Ω h√¨nh ch·ªØ nh·∫≠t bo g√≥c cho badge
            ctx.roundRect(badgeX, badgeY, badgeW, badgeH, 40);
            ctx.fill();

            ctx.fillStyle = "#1e40af";
            ctx.font = "900 48px 'Be Vietnam Pro', sans-serif, Arial";
            ctx.fillText("K·ª∑ l·ª•c m·ªõi c·ªßa t√¥i!", size/2, badgeY + 82);

            // T·∫£i ·∫£nh v·ªÅ ƒë·ªãnh d·∫°ng PNG (h·ªó tr·ª£ trong su·ªët ·ªü 4 g√≥c)
            const link = document.createElement('a');
            link.download = `EduSpace_KyLuc_${streak}.png`;
            link.href = canvas.toDataURL("image/png");
            link.click();
            closeShareModal();
        }

        window.onkeydown = (e) => { if(e.key === 'Enter') check(); };
    </script>
</body>
</html>