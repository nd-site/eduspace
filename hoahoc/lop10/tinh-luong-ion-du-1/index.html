<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán t·∫≠p: T√≠nh l∆∞·ª£ng ion d∆∞ 1 - EduSpace by ND Labs</title>
    <link rel="icon" href="/logo.png" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap');
        body { font-family: 'Nunito', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
    <script src="/nd-navbar.js" defer></script></head>
<body class="bg-blue-50 min-h-screen flex items-center justify-center p-4">

    <div class="max-w-2xl w-full bg-white rounded-2xl shadow-xl overflow-hidden" id="app">
        <!-- Header -->
        <div class="bg-blue-600 p-6 text-white text-center">
            <h1 class="text-2xl font-bold mb-2">Luy·ªán t·∫≠p: So s√°nh gi·ªõi h·∫°n</h1>
            <p class="opacity-90 text-sm">Ch·ªß ƒë·ªÅ: ƒê·ªïi ƒë∆°n v·ªã (mg ‚Üî g) v√† t√≠nh ph·∫ßn trƒÉm</p>
            
            <!-- Progress Bar -->
            <div class="mt-4 flex justify-center space-x-2">
                <div class="h-2 w-1/3 rounded-full transition-all duration-300" :class="step >= 1 ? 'bg-yellow-400' : 'bg-blue-800'"></div>
                <div class="h-2 w-1/3 rounded-full transition-all duration-300" :class="step >= 2 ? 'bg-yellow-400' : 'bg-blue-800'"></div>
                <div class="h-2 w-1/3 rounded-full transition-all duration-300" :class="step >= 3 ? 'bg-yellow-400' : 'bg-blue-800'"></div>
            </div>
            <div class="mt-1 text-xs text-right" id="progress-text">C√¢u 1/3</div>
        </div>

        <!-- Content Area -->
        <div class="p-6">
            
            <!-- Intro Screen -->
            <div id="intro" class="text-center py-8">
                <div class="text-6xl mb-4">üìù</div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">S·∫µn s√†ng luy·ªán t·∫≠p ch∆∞a?</h2>
                <p class="text-gray-600 mb-6">Ch√∫ng ta s·∫Ω l√†m 3 b√†i to√°n th·ª±c t·∫ø. H√£y chu·∫©n b·ªã m√°y t√≠nh v√† gi·∫•y nh√°p nh√©!</p>
                <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-left text-sm text-yellow-800 mb-6 mx-auto max-w-sm">
                    <strong>G·ª£i √Ω:</strong>
                    <ul class="list-disc ml-5 mt-1">
                        <li>1 g = 1000 mg</li>
                        <li>Mu·ªën ƒë·ªïi <strong>mg</strong> sang <strong>g</strong>: Chia cho 1000</li>
                        <li>Mu·ªën ƒë·ªïi <strong>g</strong> sang <strong>mg</strong>: Nh√¢n v·ªõi 1000</li>
                    </ul>
                </div>
                <button onclick="startGame()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full transition transform hover:scale-105 shadow-lg">
                    B·∫Øt ƒë·∫ßu l√†m b√†i
                </button>
            </div>

            <!-- Question Containers (Hidden by default) -->
            <div id="quiz-container" class="hidden">
                <!-- Question Content will be injected here -->
                <div id="question-content" class="fade-in"></div>

                <!-- Input Area -->
                <div id="input-area" class="mt-6 border-t pt-6">
                    <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2">1. L∆∞·ª£ng ch·∫•t n√†y c√≥ v∆∞·ª£t m·ª©c khuy·∫øn c√°o kh√¥ng?</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-50 w-1/2">
                                <input type="radio" name="answer_bool" value="yes" class="form-radio text-blue-600 h-5 w-5">
                                <span>C√≥ v∆∞·ª£t m·ª©c</span>
                            </label>
                            <label class="flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-50 w-1/2">
                                <input type="radio" name="answer_bool" value="no" class="form-radio text-blue-600 h-5 w-5">
                                <span>Kh√¥ng v∆∞·ª£t m·ª©c</span>
                            </label>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 font-bold mb-2">2. T√≠nh t·ªâ l·ªá % l∆∞·ª£ng n·∫°p v√†o so v·ªõi gi·ªõi h·∫°n:</label>
                        <div class="flex items-center">
                            <input type="number" id="answer_num" placeholder="Nh·∫≠p s·ªë (VD: 120)" class="flex-1 p-3 border rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span class="bg-gray-100 p-3 border border-l-0 rounded-r-lg text-gray-600 font-bold">%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">G·ª£i √Ω: L·∫•y (L∆∞·ª£ng th·ª±c t·∫ø / Gi·ªõi h·∫°n) x 100. L√†m tr√≤n ƒë·∫øn s·ªë nguy√™n.</p>
                    </div>

                    <button id="btn-check" onclick="checkAnswer()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-md transition">
                        Ki·ªÉm tra ƒë√°p √°n
                    </button>
                </div>

                <!-- Feedback & Explanation (Hidden initially) -->
                <div id="feedback-area" class="hidden mt-6 bg-gray-50 rounded-xl p-5 border border-gray-200 fade-in">
                    <div id="feedback-status" class="font-bold text-lg mb-2"></div>
                    
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-blue-600 font-bold mb-2"><i class="fas fa-lightbulb mr-2"></i>L·ªùi gi·∫£i chi ti·∫øt:</h3>
                        <div id="explanation-content" class="text-gray-700 space-y-2 leading-relaxed"></div>
                    </div>

                    <button id="btn-next" onclick="nextQuestion()" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-md transition flex justify-center items-center">
                        C√¢u ti·∫øp theo <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>

            <!-- Result Screen -->
            <div id="result-screen" class="hidden text-center py-8 fade-in">
                <div class="text-6xl mb-4 text-green-500"><i class="fas fa-check-circle"></i></div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Ho√†n th√†nh xu·∫•t s·∫Øc!</h2>
                <p class="text-gray-600 mb-6">B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ c√°c b√†i t·∫≠p luy·ªán t·∫≠p.</p>
                <div class="grid grid-cols-2 gap-4 max-w-xs mx-auto mb-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600" id="score-display">0/3</div>
                        <div class="text-xs text-gray-500">S·ªë c√¢u ƒë√∫ng</div>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg">
                        <div class="text-2xl font-bold text-purple-600">Master</div>
                        <div class="text-xs text-gray-500">Danh hi·ªáu</div>
                    </div>
                </div>
                <button onclick="location.reload()" class="bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-8 rounded-full transition">
                    L√†m l·∫°i t·ª´ ƒë·∫ßu
                </button>
            </div>

        </div>
    </div>

    <script>
        // Data for questions
        const questions = [
            {
                id: 1,
                title: "B√†i 1: Tr√† s·ªØa & ƒê∆∞·ªùng (mg sang g)",
                limitText: "Gi·ªõi h·∫°n ƒë∆∞·ªùng khuy·∫øn c√°o: <b>25 g</b>/ng√†y.",
                itemText: "M·ªôt c·ªëc tr√† s·ªØa ch·ª©a: <b>34.000 mg</b> ƒë∆∞·ªùng.",
                question: "N·∫øu u·ªëng 1 c·ªëc tr√† s·ªØa n√†y, l∆∞·ª£ng ƒë∆∞·ªùng n·∫°p v√†o c√≥ v∆∞·ª£t m·ª©c kh√¥ng?",
                correctBool: 'yes',
                correctNum: 136, // (34000/1000) / 25 * 100
                unit: 'g',
                convertLogic: `
                    <p><b>B∆∞·ªõc 1: ƒê·ªïi ƒë∆°n v·ªã v·ªÅ c√πng lo·∫°i (g)</b></p>
                    <p>V√¨ gi·ªõi h·∫°n t√≠nh b·∫±ng gam (g), ta ƒë·ªïi l∆∞·ª£ng ƒë∆∞·ªùng trong tr√† s·ªØa t·ª´ mg sang g:</p>
                    <p class="font-mono bg-gray-100 p-2 rounded text-center">34.000 mg : 1000 = 34 g</p>
                    
                    <p class="mt-2"><b>B∆∞·ªõc 2: So s√°nh</b></p>
                    <p>L∆∞·ª£ng n·∫°p v√†o: 34 g</p>
                    <p>Gi·ªõi h·∫°n: 25 g</p>
                    <p>‚ûú <b>34 g > 25 g</b>. V·∫≠y ƒë√£ <span class="text-red-600 font-bold">V∆Ø·ª¢T M·ª®C</span>.</p>

                    <p class="mt-2"><b>B∆∞·ªõc 3: T√≠nh ph·∫ßn trƒÉm</b></p>
                    <p>T·ªâ l·ªá = (34 : 25) √ó 100 = <b>136%</b></p>
                    <p class="text-sm text-gray-500 italic">(T·ª©c l√† v∆∞·ª£t qu√° gi·ªõi h·∫°n 36%)</p>
                `
            },
            {
                id: 2,
                title: "B√†i 2: N∆∞·ªõc tƒÉng l·ª±c & Caffeine (g sang mg)",
                limitText: "Gi·ªõi h·∫°n Caffeine an to√†n: <b>400 mg</b>/ng√†y.",
                itemText: "M·ªôt lon n∆∞·ªõc tƒÉng l·ª±c ch·ª©a: <b>0,16 g</b> caffeine. <br>T√†i x·∫ø u·ªëng <b>3 lon</b>.",
                question: "T·ªïng l∆∞·ª£ng caffeine n·∫°p v√†o t·ª´ 3 lon c√≥ v∆∞·ª£t m·ª©c an to√†n kh√¥ng?",
                correctBool: 'yes',
                correctNum: 120, 
                unit: 'mg',
                convertLogic: `
                    <p><b>B∆∞·ªõc 1: ƒê·ªïi ƒë∆°n v·ªã v·ªÅ c√πng lo·∫°i (mg)</b></p>
                    <p>ƒê·ªïi l∆∞·ª£ng caffeine trong 1 lon t·ª´ g sang mg:</p>
                    <p class="font-mono bg-gray-100 p-2 rounded text-center">0,16 g √ó 1000 = 160 mg</p>
                    
                    <p class="mt-2"><b>B∆∞·ªõc 2: T√≠nh t·ªïng l∆∞·ª£ng n·∫°p v√†o</b></p>
                    <p>U·ªëng 3 lon n√™n t·ªïng l√†: 160 √ó 3 = <b>480 mg</b></p>

                    <p class="mt-2"><b>B∆∞·ªõc 3: So s√°nh</b></p>
                    <p>Th·ª±c t·∫ø: 480 mg</p>
                    <p>Gi·ªõi h·∫°n: 400 mg</p>
                    <p>‚ûú <b>480 mg > 400 mg</b>. V·∫≠y ƒë√£ <span class="text-red-600 font-bold">V∆Ø·ª¢T M·ª®C</span>.</p>

                    <p class="mt-2"><b>B∆∞·ªõc 4: T√≠nh ph·∫ßn trƒÉm</b></p>
                    <p>T·ªâ l·ªá = (480 : 400) √ó 100 = <b>120%</b></p>
                `
            },
            {
                id: 3,
                title: "B√†i 3: M√¨ t√¥m & Mu·ªëi (mg sang g)",
                limitText: "Gi·ªõi h·∫°n Mu·ªëi (Natri) khuy·∫øn c√°o: <b>2.000 mg</b>/ng√†y.",
                itemText: "M·ªôt g√≥i m√¨ t√¥m ch·ª©a kho·∫£ng: <b>1,8 g</b> Natri.",
                question: "ƒÇn 1 g√≥i m√¨ t√¥m n·∫°p v√†o bao nhi√™u % l∆∞·ª£ng mu·ªëi cho ph√©p?",
                correctBool: 'no',
                correctNum: 90, 
                unit: 'mg',
                convertLogic: `
                    <p><b>B∆∞·ªõc 1: ƒê·ªïi ƒë∆°n v·ªã v·ªÅ c√πng lo·∫°i (mg)</b></p>
                    <p>Ta c√≥ th·ªÉ ƒë·ªïi g sang mg ƒë·ªÉ d·ªÖ so s√°nh:</p>
                    <p class="font-mono bg-gray-100 p-2 rounded text-center">1,8 g √ó 1000 = 1.800 mg</p>
                    
                    <p class="mt-2"><b>B∆∞·ªõc 2: So s√°nh</b></p>
                    <p>Th·ª±c t·∫ø: 1.800 mg</p>
                    <p>Gi·ªõi h·∫°n: 2.000 mg</p>
                    <p>‚ûú <b>1.800 mg < 2.000 mg</b>. V·∫≠y <span class="text-green-600 font-bold">CH∆ØA V∆Ø·ª¢T M·ª®C</span> (nh∆∞ng c≈©ng ƒë√£ r·∫•t g·∫ßn gi·ªõi h·∫°n).</p>

                    <p class="mt-2"><b>B∆∞·ªõc 3: T√≠nh ph·∫ßn trƒÉm</b></p>
                    <p>T·ªâ l·ªá = (1.800 : 2.000) √ó 100 = <b>90%</b></p>
                `
            }
        ];

        let currentStep = 0;
        let score = 0;

        function startGame() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentStep];
            
            // Update Progress UI
            document.getElementById('progress-text').innerText = `C√¢u ${currentStep + 1}/${questions.length}`;
            const bars = document.querySelectorAll('.rounded-full'); // Rough selection, better to use ID in real app
            
            // Render Content
            const contentDiv = document.getElementById('question-content');
            contentDiv.innerHTML = `
                <div class="flex items-center space-x-2 text-blue-600 font-bold uppercase text-sm mb-2">
                    <span class="bg-blue-100 px-2 py-1 rounded">${q.title}</span>
                </div>
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mb-4">
                    <p class="text-gray-700 mb-2"><i class="fas fa-info-circle mr-2"></i>${q.limitText}</p>
                    <p class="text-gray-800 text-lg">${q.itemText}</p>
                </div>
                <p class="font-bold text-gray-800 text-lg">${q.question}</p>
            `;

            // Reset Inputs
            const radios = document.getElementsByName('answer_bool');
            radios.forEach(r => r.checked = false);
            document.getElementById('answer_num').value = '';
            
            // Reset UI states
            document.getElementById('input-area').classList.remove('hidden');
            document.getElementById('feedback-area').classList.add('hidden');
            
            // Scroll to top
            document.getElementById('app').scrollIntoView({behavior: 'smooth'});
        }

        function checkAnswer() {
            const q = questions[currentStep];
            
            // Get inputs
            const radios = document.getElementsByName('answer_bool');
            let userBool = null;
            for (let r of radios) {
                if (r.checked) userBool = r.value;
            }
            const userNum = parseFloat(document.getElementById('answer_num').value);

            // Validate
            if (!userBool || isNaN(userNum)) {
                alert("B·∫°n vui l√≤ng ch·ªçn C√≥/Kh√¥ng v√† nh·∫≠p s·ªë ph·∫ßn trƒÉm nh√©!");
                return;
            }

            // Check correctness
            const isBoolCorrect = userBool === q.correctBool;
            // Allow small margin of error for numbers (+- 1)
            const isNumCorrect = Math.abs(userNum - q.correctNum) <= 1;
            
            const isTotalCorrect = isBoolCorrect && isNumCorrect;

            if (isTotalCorrect) score++;

            // Show feedback
            const feedbackStatus = document.getElementById('feedback-status');
            if (isTotalCorrect) {
                feedbackStatus.innerHTML = `<span class="text-green-600"><i class="fas fa-check-circle mr-2"></i>Ch√≠nh x√°c!</span>`;
            } else {
                feedbackStatus.innerHTML = `<span class="text-red-500"><i class="fas fa-times-circle mr-2"></i>Ch∆∞a ƒë√∫ng r·ªìi. H√£y xem l·ªùi gi·∫£i nh√©!</span>`;
            }

            document.getElementById('explanation-content').innerHTML = q.convertLogic;
            
            document.getElementById('input-area').classList.add('hidden');
            document.getElementById('feedback-area').classList.remove('hidden');
        }

        function nextQuestion() {
            currentStep++;
            if (currentStep < questions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('score-display').innerText = `${score}/${questions.length}`;
            document.querySelector('.h-2.w-1\\/3:nth-child(3)').classList.add('bg-yellow-400'); // Fill last bar
        }

    </script>
</body>
</html>
